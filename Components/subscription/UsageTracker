import React, { useState, useEffect } from 'react';
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Progress } from "@/components/ui/progress";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { User } from "@/entities/User";
import { createCheckoutSession } from "@/functions/createCheckoutSession";
import { Zap, Crown, Shield, AlertTriangle, Loader2 } from "lucide-react";

const USAGE_LIMITS = {
  free: 5,
  trial: 50,
  basic: 100,
  premium: 500
};

const TIER_COLORS = {
  free: "bg-slate-100 text-slate-800",
  trial: "bg-blue-100 text-blue-800", 
  basic: "bg-green-100 text-green-800",
  premium: "bg-purple-100 text-purple-800"
};

const TIER_ICONS = {
  free: Shield,
  trial: Zap,
  basic: Crown,
  premium: Crown
};

export default function UsageTracker() {
  const [userData, setUserData] = useState(null);
  const [isLoading, setIsLoading] = useState(true);
  const [isUpgrading, setIsUpgrading] = useState(false);
  const [error, setError] = useState(null);

  useEffect(() => {
    loadUserData();
  }, []);

  const loadUserData = async () => {
